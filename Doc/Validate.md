# Валидация

Все данные, приходящие от клиентов, необходимо проверять. **d7k.Dto** предоставляет такую возможность

```csharp
static void Main(string[] args)
{
	var dto = new DtoComplex().ByNestedClassesWithAttributes();

	var cat = new Cat() { Name = "  Snow  " };
	
	dto.FixValue(cat, nameof(cat), x => x.NotEmpty().ValidateDto());
	//cat.Name == "Snow"
}

class Cat
{
	public string Name { get; set; }
}

[DtoContainer]
public static class Dto
{
	[DtoValidate]
	static void Validate(ValidationRuleFactory<Cat> t)
	{
		t.RuleFor(x => x.Name).Trim().NotEmpty();
	}
}
```

**ValidateDto** это еще один метод расширения в нашем DtoComplexHelper:

```csharp
public static class DtoComplexHelper
{
...
	public static PathValidation<TSrc, TProperty> ValidateDto<TSrc, TProperty>(this PathValidation<TSrc, TProperty> validation)
	{
		return validation.ValidateDto(m_dto);
	}
}
```

Механизм валидации может не только проверить корректность присланных данных, но и скорректировать какие-то простые случае. В нашем примере - убрать пустые символы в начале и в конце строки.

В качестве валидируемой сущности может выступать интерфейс. Поэтому, классы могут быть разделены на интерфейсы и валидация может производиться для каждого интерфейса в отдельности. Другие классы для которых определен этот интерфейс автоматически будут иметь эти валидаторы

## Стандартизация пустых значений

Для каждой структуры существует свой ответ, что такое "пустое значение" в том или ином ее поле: null, string.Empty, пустой массив или кастомный NullObject. В одном месте удобен один подход, в другом то же самое решение приводит к странным последствиям. Например к такому: **if (obj.A is MyNullObject) ...**.

Решение и стандартизация данного вопроса на ранних этапах исполнения запросов исключит появление ненужных **if** конструкиций в дальнейшем, сделав код более ориентированным на решение бизнес задач, а не "проблем" языка (в нашем случае C#).

К сожалению, заставить клиента всегда следовать заданным требованиям - задача противоричивая и приводит к конфликтам внутри команды:
- Почему я должен в поле A передавать пустой массив, а в поле B null?
- Ну ... моя ORM будет трактовать это значение ...

**ORM**? Серьезно? Какое дело клиенту до твоей ORM? У него есть 50 аналогичных арументов сделать иначе.

**d7k.Dto** считает, что клиент может следовать любому, удобному для него, подходу. Во время валидации входных значений сервер легко сможет привести все в "правильный" для него вид. Счастливы **клиент** и **ORM** одновременно.
